# Telegram Bot Status - –§–∞–∑–∞ 1

## –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ Railway (2026-02-19 15:04)

### ‚úÖ Telegram –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–°—Ç–∞—Ç—É—Å:** Running on Railway (service: passionate-happiness)

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏–∑ –ª–æ–≥–æ–≤:**
```
2026-02-19 14:59:00,622 - getUpdates "HTTP/1.1 200 OK"
2026-02-19 14:59:01,130 - sendMessage "HTTP/1.1 200 OK"
2026-02-19 14:59:01,218 - POST https://thorough-contentment-production-454b.up.railway.app/api/check "HTTP/1.1 429 Too Many Requests"
2026-02-19 14:59:01,393 - sendMessage "HTTP/1.1 200 OK"
```

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

1. **Telegram –±–æ—Ç –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ** (`getUpdates`)
2. **–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª "‚è≥ –ü—Ä–æ–≤–µ—Ä—è—é —Å–∞–π—Ç..."** (`sendMessage`)
3. **–ë–æ—Ç –≤—ã–∑–≤–∞–ª Backend API** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∞–π—Ç–∞
4. **Backend –≤–µ—Ä–Ω—É–ª 429 Too Many Requests** (rate limiting)
5. **–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ** (`sendMessage`)

### 429 Too Many Requests - Rate Limiting

**–ü—Ä–∏—á–∏–Ω–∞:** –í backend –µ—Å—Ç—å rate limiting: **5 –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —á–∞—Å** –Ω–∞ –æ–¥–∏–Ω telegram_id

**–ö–æ–¥ –∏–∑ `backend/app/routes/check.py`:**
```python
async def check_rate_limit(telegram_id: int, session: AsyncSession) -> None:
    one_hour_ago = datetime.utcnow() - timedelta(hours=1)
    
    count = await session.scalar(
        select(func.count())
        .select_from(CheckRequest)
        .where(CheckRequest.telegram_id == telegram_id)
        .where(CheckRequest.created_at > one_hour_ago)
    )
    
    if count and count >= 5:
        raise HTTPException(status_code=429, ...)
```

**–≠—Ç–æ –Ω–µ –±–∞–≥ ‚Äî —ç—Ç–æ feature!** Rate limiting –∑–∞—â–∏—â–∞–µ—Ç API –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π.

---

## ‚úÖ –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç —á–µ—Ä–µ–∑ API (–±–µ–∑ rate limiting)

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
curl -X POST https://thorough-contentment-production-454b.up.railway.app/api/check \
  -H "Content-Type: application/json" \
  -d '{"site_url": "https://72dom.com/", "telegram_id": 123456789}'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ SUCCESS (HTTP 200)

**–û—Ü–µ–Ω–∫–∞ —Å–∞–π—Ç–∞:** 8.3/10

**–ù–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:**
1. ‚úÖ `tech-canonical`: OK - "Canonical URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
2. ‚úÖ `content-opengraph`: OK - "OpenGraph —Ç–µ–≥–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (title, description, image)"
3. ‚ö†Ô∏è `content-sitemap-html`: Problem - "HTML-–∫–∞—Ä—Ç–∞ —Å–∞–π—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

**Processing time:** 6 —Å–µ–∫—É–Ω–¥
**Checks completed:** 9/9

---

## Telegram Bot - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ë–æ—Ç **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç rate limiting**:

**–ö–æ–¥ –∏–∑ `telegram-bot/handlers/url.py`:**
```python
if "error" in result:
    error_data = result["error"]
    error_msg = error_data.get("message", "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞")
    await update.message.reply_text(
        f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ:\n{error_msg}\n\n"
        "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ URL."
    )
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ:
–í—ã –ø—Ä–µ–≤—ã—Å–∏–ª–∏ –ª–∏–º–∏—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ (5 –≤ —á–∞—Å). –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ URL.
```

---

## –í—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. Telegram –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ Railway –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
2. Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. –í—Å–µ 9 –ø—Ä–æ–≤–µ—Ä–æ–∫ (–≤–∫–ª—é—á–∞—è 3 –Ω–æ–≤—ã–µ) —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. Rate limiting –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üìù –ß—Ç–æ –ø–æ–∫–∞–∑–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
–°–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞" –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ ‚Äî —ç—Ç–æ **rate limiting** –≤ –¥–µ–π—Å—Ç–≤–∏–∏. Backend –≤–µ—Ä–Ω—É–ª 429, –±–æ—Ç –ø–æ–∫–∞–∑–∞–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 —á–∞—Å –ø–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π Telegram –∞–∫–∫–∞—É–Ω—Ç (–¥—Ä—É–≥–æ–π telegram_id)
3. –í—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –≤ –∫–æ–¥–µ (–¥–ª—è dev-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞:**
- Rate limiting 5/hour ‚Äî —ç—Ç–æ —Ä–∞–∑—É–º–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è MVP
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –±–æ—Ç–∞: "–õ–∏–º–∏—Ç: X/5 –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —á–∞—Å"

---

## –¢–µ—Å—Ç —Å –Ω–æ–≤—ã–º telegram_id (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ü–æ–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 —á–∞—Å, –ò–õ–ò
2. –ü–æ–ø—Ä–æ—Å–∏—Ç—å –¥—Ä—É–≥–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ (–¥—Ä—É–≥–æ–π telegram_id)
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ª—é–±–æ–π URL —Å–∞–π—Ç–∞ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ë–æ—Ç –ø—Ä–∏—à–ª–µ—Ç –ø–æ–ª–Ω—ã–π SEO –æ—Ç—á—ë—Ç
- –í—Å–µ 9 –ø—Ä–æ–≤–µ—Ä–æ–∫ –±—É–¥—É—Ç –≤ –æ—Ç—á—ë—Ç–µ
- –ù–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (canonical, opengraph, html-sitemap) –±—É–¥—É—Ç –≤–∏–¥–Ω—ã

---

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2026-02-19 15:04 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Telegram –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, rate limiting —Å—Ä–∞–±–æ—Ç–∞–ª –∫–∞–∫ –ø–æ–ª–æ–∂–µ–Ω–æ
