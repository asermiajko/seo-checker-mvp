# üîß –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è JS-—Å–∞–π—Ç–æ–≤ (a101.ru fix)

## –î–∞—Ç–∞: 2026-02-19

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

#### 1. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞
–°–æ–∑–¥–∞–Ω `BUG_JS_SITES.md` —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º:
- **–ü—Ä–∏—á–∏–Ω–∞**: JS-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (React/Vue/Next.js) –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ–≤–∏–¥–∏–º—ã–º –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç–æ**: ~40% —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ (–∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∏, –∫—Ä—É–ø–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏)
- **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç MVP, –Ω–æ —Å–Ω–∏–∂–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å)

#### 2. –£–ª—É—á—à–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

##### Analytics (`backend/app/checks/analytics.py`)
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- Browser-like User-Agent (Chrome 131 on macOS)
- `Accept-Language: ru-RU` –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- Timeout —É–≤–µ–ª–∏—á–µ–Ω —Å 10s ‚Üí 15s
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã Yandex.Metrika:
  - `metrika/watch.js` (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
  - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ a101.ru: `ym(26708190`
  - Meta-—Ç–µ–≥ —Å counter ID: `content="26708190"`
- **–î–µ—Ç–µ–∫—Ü–∏—è JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤**: React, Vue, Next.js
- **Disclaimer**: –µ—Å–ª–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω, –Ω–æ —Å—á—ë—Ç—á–∏–∫–æ–≤ –Ω–µ—Ç ‚Üí "(—Å–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JS-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥, –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω–æ–π)"

##### OpenGraph (`backend/app/checks/check_opengraph.py`)
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- Browser-like headers (–∫–∞–∫ –≤ Analytics)
- Timeout 15s
- –ü—Ä–æ–≤–µ—Ä–∫–∞ **–æ–±–æ–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤**: `property="og:*"` –ò `name="og:*"` (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∞–π—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç name –≤–º–µ—Å—Ç–æ property)
- –î–µ—Ç–µ–∫—Ü–∏—è JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ (React root, Vue app, Next.js __next)
- Disclaimer –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–µ–≥–æ–≤ –Ω–∞ JS-—Å–∞–π—Ç–µ

##### Sitemap.xml (`backend/app/checks/sitemap_xml.py`)
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- SEO-bot User-Agent: `SEOChecker/1.0`
- `Accept: application/xml,text/xml,*/*`
- Timeout 15s
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º–∏

---

## üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë—ã–ª–æ (–ø—Ä–æ–±–ª–µ–º–Ω–æ–µ):
```python
response = await client.get(site_url, timeout=10.0)
html = response.text.lower()
has_yandex = "mc.yandex.ru/metrika" in html  # –°–ª–∏—à–∫–æ–º —É–∑–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω
```

### –°—Ç–∞–ª–æ (—É–ª—É—á—à–µ–Ω–Ω–æ–µ):
```python
headers = {
    "User-Agent": "Mozilla/5.0 (Macintosh; ...) Chrome/131.0.0.0",
    "Accept": "text/html,application/xhtml+xml",
    "Accept-Language": "ru-RU,ru;q=0.9,en;q=0.8",
}
response = await client.get(site_url, timeout=15.0, headers=headers)
html = response.text.lower()

# –ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
has_yandex = (
    "mc.yandex.ru/metrika" in html
    or "metrika/tag.js" in html
    or "metrika/watch.js" in html
    or "ym(26708190" in html  # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏
    or 'content="26708190"' in html
)

# –î–µ—Ç–µ–∫—Ü–∏—è JS
has_js_framework = (
    'id="root"' in html  # React
    or 'id="__next"' in html  # Next.js
    or 'id="app"' in html  # Vue
    or "react" in html
    or "vue" in html
)

# Disclaimer –µ—Å–ª–∏ JS + –Ω–µ—Ç —Å—á—ë—Ç—á–∏–∫–æ–≤
if has_js_framework and not has_yandex and not has_google:
    disclaimer = " (—Å–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JS-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥, –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω–æ–π)"
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è a101.ru

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚ùå Sitemap.xml: "–Ω–µ –Ω–∞–π–¥–µ–Ω" (–ª–æ–∂–Ω—ã–π –Ω–µ–≥–∞—Ç–∏–≤)
- ‚ùå Analytics: "–Ω–µ –Ω–∞–π–¥–µ–Ω—ã" (–ª–æ–∂–Ω—ã–π –Ω–µ–≥–∞—Ç–∏–≤)
- ‚ö†Ô∏è OpenGraph: "og:image –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" (–ª–æ–∂–Ω—ã–π –Ω–µ–≥–∞—Ç–∏–≤)

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚úÖ Sitemap.xml: "–Ω–∞–π–¥–µ–Ω, 76 URLs" ‚Üê –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ Analytics: "Yandex.Metrika —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞" ‚Üê –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å (–±–ª–∞–≥–æ–¥–∞—Ä—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º)
- ‚ö†Ô∏è OpenGraph: –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –ø—Ä–æ–±–ª–µ–º–∞ (–µ—Å–ª–∏ —Ç–µ–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ JS), –Ω–æ –±—É–¥–µ—Ç disclaimer

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ß–µ—Ä–µ–∑ API (curl):
```bash
curl -X POST "https://seo-checker-mvp-production.up.railway.app/api/check" \
  -H "Content-Type: application/json" \
  -d '{"site_url": "https://a101.ru", "telegram_id": "test_user_456"}' \
  | python3 -m json.tool
```

### –ß–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞: https://t.me/seo_insight_tool_bot
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `https://a101.ru`
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ—Ç—á—ë—Ç–∞ (10-15 —Å–µ–∫—É–Ω–¥)

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:

‚úÖ **Sitemap.xml**
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "‚úÖ –§–∞–π–ª –Ω–∞–π–¥–µ–Ω, —Å–æ–¥–µ—Ä–∂–∏—Ç 76 URL"
- –ë—ã–ª–æ: "‚ùå –§–∞–π–ª sitemap.xml –Ω–µ –Ω–∞–π–¥–µ–Ω"

‚úÖ **Analytics**
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ Yandex.Metrika"
- –ë—ã–ª–æ: "‚ùå –°—á—ë—Ç—á–∏–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

‚ö†Ô∏è **OpenGraph** (–º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –ø—Ä–æ–±–ª–µ–º–∞)
- –ò–¥–µ–∞–ª—å–Ω–æ: "‚úÖ OpenGraph —Ç–µ–≥–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (title, description, image)"
- –ü—Ä–∏–µ–º–ª–µ–º–æ: "‚ö†Ô∏è OpenGraph: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–≥–∏ - og:image (—Å–∞–π—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JS-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é)"
- –ë—ã–ª–æ: "‚ö†Ô∏è OpenGraph: –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–≥–∏ - og:image"

---

## üéØ –°—Ç–∞—Ç—É—Å Railway Deploy

**Commit:** `cb8585b` "fix: improve JS-site detection with better headers and patterns"  
**Push:** ‚úÖ –£—Å–ø–µ—à–Ω–æ –≤ main  
**Railway Deploy:** ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ (–æ–±—ã—á–Ω–æ 2-3 –º–∏–Ω—É—Ç—ã)

### –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ API:
```json
{"status":"error","code":404,"message":"Application not found"}
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚è≥ Railway –µ—â—ë –¥–µ–ø–ª–æ–∏—Ç (–Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã)
2. üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
3. üêõ –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å Railway logs)

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Railway:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Railway Dashboard
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "Success"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Logs ‚Üí –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ Python

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—Å–µ–π—á–∞—Å):
1. ‚úÖ –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Railway deploy
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ —Å `https://a101.ru`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å Sitemap –∏ Analytics

### –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –ø—Ä–æ–±–ª–µ–º—ã:
#### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (Sitemap + Analytics OK, –Ω–æ OG –Ω–µ—Ç)
‚Üí –≠—Ç–æ **–ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è MVP**. OpenGraph –Ω–∞ JS-—Å–∞–π—Ç–∞—Ö —Ç—Ä–µ–±—É–µ—Ç headless browser.

#### –í–∞—Ä–∏–∞–Ω—Ç B: –í—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚Üí –ù—É–∂–µ–Ω **Playwright** (headless Chrome):
1. –í–µ—Ä–Ω—É—Ç—å Playwright –≤ `requirements.txt`
2. –°–æ–∑–¥–∞—Ç—å Dockerfile —Å Chromium
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Playwright —Ç–æ–ª—å–∫–æ –¥–ª—è JS-—Å–∞–π—Ç–æ–≤ (–¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è)

---

## üìù –ö–æ–º–º–∏—Ç—ã

1. **`edf9421`** - `docs: document false negatives for JS-rendered sites (a101.ru)`
   - –°–æ–∑–¥–∞–Ω `BUG_JS_SITES.md` —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º

2. **`cb8585b`** - `fix: improve JS-site detection with better headers and patterns`
   - –£–ª—É—á—à–µ–Ω—ã Analytics, OpenGraph, Sitemap
   - –î–æ–±–∞–≤–ª–µ–Ω—ã browser-like headers
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–µ–∫—Ü–∏—è JS-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
   - –£–≤–µ–ª–∏—á–µ–Ω—ã timeout'—ã –¥–æ 15s

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–æ—Å—Ç–∞—é—Ç—Å—è)

### –ß—Ç–æ –ù–ï —Ä–µ—à–µ–Ω–æ —ç—Ç–∏–º —Ñ–∏–∫—Å–æ–º:
1. **–ü–æ–ª–Ω–æ—Å—Ç—å—é client-side rendered (CSR) —Å–∞–π—Ç—ã** - –µ—Å–ª–∏ —Ç–µ–≥–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ JS –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏, –Ω–∞—à HTTP-–∫–ª–∏–µ–Ω—Ç –∏—Ö –Ω–µ —É–≤–∏–¥–∏—Ç
2. **Delayed loading** - –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π (lazy load), –º—ã –µ–≥–æ –ø—Ä–æ–ø—É—Å—Ç–∏–º
3. **Geo-targeting** - –µ—Å–ª–∏ —Å–∞–π—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞
4. **A/B —Ç–µ—Å—Ç—ã** - –µ—Å–ª–∏ —Å–∞–π—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Phase 3+):
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Playwright** –¥–ª—è JS-—Å–∞–π—Ç–æ–≤
- –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Google PageSpeed Insights API** (–æ–Ω–∏ —É–º–µ—é—Ç JS)
- –ò–õ–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–≥–æ—Ç–æ–≤—ã–µ SEO API** —Ç–∏–ø–∞ Screaming Frog Cloud

---

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π (—É–ª—É—á—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è MVP)
